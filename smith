#!/bin/bash

GREEN='\033[0;32m'
END='\033[0m'

if [[ $1 == "" ]] || [[ $1 == "-h" ]] || [[ $1 == "--help" ]]; then
	echo "smith <host>"
	echo "smith http.//example.com"
	echo "or"
	echo "smith <list of hosts>"
	echo "smith list.txt"
	exit 1
fi

meg -d 100 -c 200 wordlist.txt "$1" 2> /dev/null

search() {
	results=$(grep -rliE "$1" out)
	if [[ -n "$results" ]]; then
		while read -r url; do
			head -1 "$url";
		done <<< "$results"
	fi
}

echo -e "${GREEN}==> Webalizer Instances <==${END}"
search "webalizer"
echo

echo -e "${GREEN}==> GitLab Instances <==${END}"
search "Explore GitLab"
echo

echo -e "${GREEN}==> Gitea Instances <==${END}"
search "Gitea Version:"
echo

echo -e "${GREEN}==> phpinfo() pages <==${END}"
search "PHP Version"
echo

echo -e "${GREEN}==> Public ssh keys <==${END}"
search "ssh-rsa"
echo

echo -e "${GREEN}==> Apache Server Status files <==${END}"
search "Apache Server Status for"
echo

echo -e "${GREEN}==> Perl CGI environment variables <==${END}"
search "GATEWAY_INTERFACE=\"CGI"
echo

echo -e "${GREEN}==> CRLF injection vulnerabilities <==${END}"
search "< Set-Cookie: ?crlf"
echo

echo -e "${GREEN}==> Open redirect vulnerabilities <==${END}"
search '< location: (https?:)?[/\\]{2,}example.com'
echo